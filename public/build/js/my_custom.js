$(function(){$.ajaxSetup({headers:{"X-CSRF-Token":$("meta[name=_token]").attr("content")}})}),$(document).ready(function(){var e={manageDynamicLoader:function(e){"show"==e?$(".loaderbg").removeClass("hide"):$(".loaderbg").addClass("hide")},registerGlobalDomFunctions:function(){$(".page-content .date").each(function(){$(this).datepicker()}),$(".tools").each(function(){$(this).hide()});var r=null,i=null;$(".icon-custom-left, .go-back").on("click",function(n){if(e.manageDynamicLoader("show"),$(this).hasClass("icon-custom-left"))return e.manageDynamicLoader("hide"),$(this).siblings("h3").eq(0).find("span").eq(0).click(),!1;if(array_length=t.length,length=array_length-2,"search"==$(this).data("from"))return"default"==a?(location.reload(),!1):(getUrl=a[0]+"/"+a[1],a[0]=a[0],a[1]=a[1],"undefined"!=a[2]&&(getUrl=getUrl+"/"+a[2],a[2]=a[2]),$.get(getUrl,function(t){return $(".page-content").html(t),$(".page-content .datatable").dataTable(),e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions(),!1}),!1);if(2===t.length)location.reload();else{if("undefined"==typeof t[length])return location.reload(),!1;r=t[length][0],i=t[length][1],t.pop(),getUrl=r+"/"+i,a[0]=r,a[1]=i,e.setDefaultActionActive(r,i,"normal"),"undefined"!=typeof t[length][2]&&(getUrl=r+"/"+i+"/"+t[length][2],a[2]=t[length][2]),$.get(getUrl,function(t){$(".page-content").html(t),$(".page-content .datatable").dataTable(),e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions()})}}),$("#assign_contact_modal_close, #assign_contact_modal_cancel, .assign_contact_modal_back").on("click",function(e){e.preventDefault(),$("#assign_offer_partners").modal("hide"),$("#list_offer_partners").modal("show")}),$("#assign_partner_contacts_id").off().on("click",function(t){console.log("here"),t.preventDefault(),project_id=$("#offer_project_select").val(),""==project_id&&(project_id=0),console.log(project_id),$.ajax({url:"partner/list-by-offer/"+project_id,type:"GET",success:function(t){return"undefined"!=typeof t.exc?alert("Whoops! Your request can not be performed at this time. Please try again later."):$("#list_offer_partners_dialog").html(t),e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions(),!1}})}),$("form").off().on("submit",function(t){if(t.preventDefault(),e.manageDynamicLoader("show"),form_id="#"+$(this).attr("id"),ctrl=$(this).data("controller"),type=$(this).data("type"),ckeditor=$(this).data("ckeditor"),method=$(this).data("method"),is_modal=$(this).data("modal"),"offer"==ctrl&&"update"==method&&!confirm("Are you sure you want to update this offer?"))return e.manageDynamicLoader("hide"),!1;if("yes"==ckeditor)for(instance in CKEDITOR.instances)CKEDITOR.instances[instance].updateElement();return"multipart"==type?n.multipartFormHandler(ctrl,form_id,method):"yes"==is_modal?n.modalFormHandler(ctrl,form_id,method):n.commonFormHandler(ctrl,form_id,method),!1}),$(".datatable").off().on("click",".assigncontact, .editcontact, .assign_project, .editclient, .editpartner, .editchannel, .edit_general_offer_type, .edit_detailed_offer_type, .edit_offer_type_category, .editproject, .edit_placement, .edit_offer, .edit_offer_placement, .edit_email_template, .edit_email, .edit_communication_package, .edit_user, .edit_country, .edit_language, .edit_category",function(t){return t.preventDefault(),e.manageDynamicLoader("show"),ctrl=$(this).data("controller"),id=$(this).data("id"),partial_view=$(this).data("partial"),method=$(this).data("method"),void 0!=partial_view?(n.anchorHandlerPartialType(ctrl,id,method,partial_view),!1):(e.registerGlobalDomFunctions(),void n.commonAnchorHandler(ctrl,id,method))}),$(".datatable").on("click",".deletecontact, .deleteclient, .deletepartner, .deleteproject, .deletechannel, .delete_general_offer_type, .delete_detailed_offer_type, .delete_offer_type_category, .delete_placement, .delete_offer, .delete_email_template, .delete_email, .delete_communication_package, .delete_user, .delete_country, .delete_language, .delete_category",function(t){return t.preventDefault(),e.manageDynamicLoader("show"),ctrl=$(this).data("controller"),id=$(this).data("id"),method=$(this).data("method"),"delete"!=method||confirm("Are you sure you want to delete?")?void n.commonDeleteHandler(ctrl,id,method):(e.manageDynamicLoader("hide"),!1)}),$(".body_action_link").on("click",function(t){return t.preventDefault(),e.manageDynamicLoader("show"),ctrl=$(this).data("controller"),id=$(this).data("id"),partial_view=$(this).data("partial"),method=$(this).data("method"),void 0!=partial_view?(n.anchorHandlerPartialType(ctrl,id,method,partial_view),!1):void n.commonAnchorHandler(ctrl,id,method)}),$(".datatable").on("click",".assign_contact_modal",function(t){t.preventDefault(),e.manageDynamicLoader("show"),ctrl=$(this).data("controller"),id=$(this).data("id"),method=$(this).data("method"),selector=$(this).data("selector"),n.modalAnchorHandler(ctrl,id,method,selector)}),$("#contact-language").off().on("change",function(e){return e.preventDefault(),language_id=$(this).val(),all_titles=$("#title_mr, #title_mrs, #title_ms, #title_herr, #title_frau"),german_titles=$("#title_herr, #title_frau"),english_titles=$("#title_mr, #title_mrs, #title_ms"),""!=language_id?2==language_id?(english_titles.hide(),german_titles.show(),$("#contact-title").val("Select Below"),!1):(german_titles.hide(),english_titles.show(),$("#contact-title").val("Select Below"),!1):(all_titles.hide(),$("#contact-title").val("Select Below"),!1)}),$(".datatable").on("click",".contact_id",function(e){$this=$(this);var t=$this.attr("id"),a=$this.closest("form#contact_assign_form").eq(0);if(!a.length)var a=$this.closest("form#contact_assign_form_modal").eq(0);if($this.is(":checked")){var n='<input type="hidden" name="assign_contact_id[]" class="'+t+'" value="'+$this.val()+'">';a.prepend(n)}else{var o=$("input[type='hidden']."+t);o.remove()}}),$("#address_form_btn").off().on("click",function(e){e.preventDefault(),$("#address_form_wrapper").slideToggle()}),$("#logo").off().on("change",function(){var t=this.value.split(/[\/\\]/).pop(),a=o.fileCheck($("#logo"));if(0!=a)return!1;var n=this.files?this.files:[];if(n.length&&window.FileReader){if(/^image/.test(n[0].type)){var r=new FileReader;r.readAsDataURL(n[0]),r.onloadend=function(){$("#img_preview").css("background-image","url("+this.result+")"),$("#img_preview").css("background-size","165px 165px"),$("#img_preview").css("background-repeat","no-repeat"),$("#logo_text").val(t),$("#project_delete_logo").show(),$("#project_logo_img").remove()}}else $("#img_preview").css("background-image","url('assets/images/image-preview.png')"),$("#logo_text").val(""),$("#old_project_logo_img").show(),$("#project_delete_logo").hide();e.registerGlobalDomFunctions()}}),$("#client").off().on("change",function(t){return t.preventDefault(),client_id=$(this).val(),""==client_id?($("#client_contact").html("<option disabled>N/A</option>"),!1):void $.ajax({url:"client/client-contact/"+client_id,type:"GET",success:function(t){return"undefined"!=typeof t.exc?alert("Whoops! Your request can not be performed at this time. Please try again later."):""==t?$("#client_contact").html("<option disabled>N/A</option>"):$("#client_contact").html(t),e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions(),!1}})}),$("#project_delete_logo").off().on("click",function(t){return t.preventDefault(),e.manageDynamicLoader("show"),confirm("Are you sure you want to delete this project logo?")?($("#img_preview").css("background-image","url('assets/images/image-preview.png')"),$("#logo_text").val(""),$(this).hide(),$("#old_project_logo_img").show(),e.registerGlobalDomFunctions(),e.manageDynamicLoader("hide"),!1):(e.manageDynamicLoader("hide"),!1)}),$("#show_projectlogo_delete").off().on("click",function(t){$this=$(this),e.manageDynamicLoader("show");var a=$this.data("mode"),n=$this.data("id");return confirm("Are you sure you want to delete this project logo?")?void $.ajax({url:"project/"+a+"/"+n,type:"GET",success:function(t){return"undefined"!=typeof t.exc?alert("Whoops! Requested project logo could not delete this time. Please try again later."):e.commonViewLoad(t),e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions(),!1}}):(e.manageDynamicLoader("hide"),!1)}),$("#placement_project_select").off().on("change",function(t){return t.preventDefault(),project_id=$(this).val(),""==project_id?($("#placement_channel_select").html('<option value="">Select Below</option>'),!1):void $.ajax({url:"placement/channel-by-project/"+project_id,type:"GET",success:function(t){return"undefined"!=typeof t.exc?alert("Whoops! Your request can not be performed at this time. Please try again later."):$("#placement_channel_select").html(t),e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions(),!1}})}),$(".offer_status_label").off().on("click",function(e){net=$(this).parent().next().children("input:checkbox").prop("checked",!1)}),$(".offer_status_na_label").off().on("click",function(e){net=$(this).parent().prev().children("input:checkbox").prop("checked",!1)}),$("#offer_project_select").off().on("change",function(t){t.preventDefault(),project_id=$(this).val(),""!=project_id?($.ajax({url:"offer/form-data-by-project/"+project_id,type:"GET",success:function(t){return"undefined"!=typeof t.exc?alert("Whoops! Your request can not be performed at this time. Please try again later."):$("#select_project_view_wrapper").html(t),e.registerGlobalDomFunctions(),!1}}),$.ajax({url:"offer/project-ji-users/"+project_id,type:"GET",success:function(t){if("undefined"!=typeof t.exc)alert("Whoops! Your request can not be performed at this time. Please try again later.");else{select_na='<option value="">Select Below</option>',select_na_disabled='<option value="" disabled="disabled">N/A</option>',$("#offer_ji_contact_select").html(select_na),$("#offer_secondary_jiuser_select").html("");var a=jQuery.parseJSON(t);$.each(a,function(e,t){$("#offer_ji_contact_select").append('<option value="'+t.id+'">'+t.first_name+" "+t.last_name+"</option>"),$("#offer_secondary_jiuser_select").append('<option value="'+t.id+'">'+t.first_name+" "+t.last_name+"</option>")})}return e.registerGlobalDomFunctions(),!1}})):(select_na='<option value="">Select Below</option>',select_na_disabled='<option value="" disabled="disabled">N/A</option>',na_option='<p class="label">No matching records found.</p>',$("#offer_placement_select_wrapper, #offer_partner_select_wrapper, #offer_offer_tc_select_wrapper, #offer_general_ot_select_wrapper, #offer_detailed_ot_select_wrapper, #offer_partner_contact_select_wrapper").html(na_option),$("#offer_ji_contact_select").html(select_na),$("#offer_secondary_jiuser_select").html(select_na_disabled))}),$("#offer_partner_select").off().on("change",function(t){t.preventDefault(),partner_id=$(this).val(),""!=partner_id?$.ajax({url:"offer/partner-contacts-by-partner/"+partner_id,type:"GET",success:function(t){return"undefined"!=typeof t.exc?alert("Whoops! Your request can not be performed at this time. Please try again later."):$("#select_primary_contact_partial_wrapper").html(t),e.registerGlobalDomFunctions(),!1}}):(no_data='<p class="label">No matching records found.</p>',$("#offer_partner_contact_select_wrapper").html(no_data))}),$("#select_offer_placement_id").off().on("change",function(t){return t.preventDefault(),placement_id=$(this).val(),offer_id=$("#offer_id").val(),post_data={placement_id:placement_id,offer_id:offer_id},""==placement_id?($("#placement_start_date, #placement_end_date").val("").attr("disabled","disabled"),!1):void $.ajax({url:"offer/placement-by-offer",data:post_data,type:"POST",success:function(t){return"undefined"!=typeof t.exc?alert("Whoops! Your request can not be performed at this time. Please try again later."):($("#placement_start_date").val(t[0].placement_start_date),$("#placement_end_date").val(t[0].placement_end_date),$("#offer_placement_id").val(t[0].id),$("#placement_start_date, #placement_end_date").prop("disabled",!1)),e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions(),!1}})}),$("#offer_ji_contact_select").off().on("change",function(t){project_id=$("#offer_project_select").val(),t.preventDefault(),ji_contact_id=$("#offer_ji_contact_select").val(),""==ji_contact_id&&(ji_contact_id=0),$.ajax({url:"offer/secondary-users-data/"+ji_contact_id+"/"+project_id,type:"GET",success:function(t){return"undefined"!=typeof t.exc?alert("Whoops! Your request can not be performed at this time. Please try again later."):$("#secondary_users_wrapper").html(t),e.registerGlobalDomFunctions(),!1}})}),$("#email_template_attach").off().on("click",function(e){$this=$(this);var t=$this.siblings('input[type="file"].empty_file');t.click()}),$(".template_add_attachment").off().on("change",function(t){$this=$(this);var a=$this.val().split("/").pop().split("\\").pop(),n=a.split("/").pop().split("\\").pop(),o='<span class="attachment-item">'+n+'&nbsp;<a class="delete_template_attachment" style="cursor:pointer" data-toggle="tooltip" data-placement="top" data-original-title="Delete"><i class="fa fa-trash-o"></i></a>&nbsp;&nbsp;&nbsp;</span>',r='<input type="file" name="attachments[]" id="" style="display:none;" class="template_add_attachment empty_file">';$this.removeClass("empty_file").siblings(".attachment-content-wrapper").append(o).end().parent(".attachment_main_wrapper").append(r),e.registerGlobalDomFunctions()}),$(".delete_template_attachment").off().on("click",function(t){if(!confirm("Are you sure you want to delete this attachment?"))return!1;var a=$(this).parent(),n=a.index(),o=$("span.attachment-item").length,r=$(".template_add_attachment").length-1,i=o-r,l=n-i,s=$(this).data("id");if(void 0!=s){var c=$(this).data("attachment"),d={id:s,file:c};$.ajax({url:"email-template/delete-attachment",data:d,type:"POST",success:function(e){0==e?alert("Could not find/delete this file now. Please try again."):a.remove()}})}else o==r?($(".template_add_attachment").eq(n).remove(),a.remove()):(a.remove(),$(".template_add_attachment").eq(l).remove());e.registerGlobalDomFunctions()}),$("#email_template_type").off().on("change",function(e){var t=$(this).val(),a=["{activation_link}"],n=["{microsite1_link_en}","{microsite1_link_de}"],o=["{microsite2_link_en}","{microsite2_link_de}"],r=["{microsite2_link_en}","{microsite2_link_de}"];if(""!=t)switch(t){case"activation":$("span.variables_wrapper").html(""),$("#sender_email").removeAttr("disabled"),$.each(a,function(e,t){t=" "+t,$("span.variables_wrapper").append(t)});break;case"offer_extension":$("span.variables_wrapper").html("No matching variables found."),$("#sender_email").val("").attr("disabled","disabled");break;case"microsite1":$("span.variables_wrapper").html(""),$("#sender_email").removeAttr("disabled"),$.each(n,function(e,t){t=" "+t,$("span.variables_wrapper").append(t)});break;case"microsite2_final":$("span.variables_wrapper").html(""),$("#sender_email").removeAttr("disabled"),$.each(o,function(e,t){t=" "+t,$("span.variables_wrapper").append(t)});break;case"microsite2_reminder":$("span.variables_wrapper").html(""),$("#sender_email").removeAttr("disabled"),$.each(r,function(e,t){t=" "+t,$("span.variables_wrapper").append(t)});break;default:$("#sender_email").removeAttr("disabled"),$("span.variables_wrapper").html("No matching variables found.")}else $("span.variables_wrapper").html("No matching variables found.")}),$(".add_cc_address").off().on("click",function(t){t.preventDefault();var a="";a+='<div class="col-md-4 cc_item">',a+='<label for="cc_emails"><a class="btn btn-warning btn-mini remove_cc_address"><i class="fa fa-times"></i>&nbsp;Remove</a></label>',a+='<div class="cc_emails_wrapper" id="cc_emails_wrapper">',a+='<input name="cc_emails[]" id="" type="text"  class="form-control" placeholder="CC Email" value="">',a+="</div>",a+="</div>",$("span.cc_emails_wrapper").append(a),e.registerGlobalDomFunctions()}),$("a.remove_cc_address").off().on("click",function(t){$(this).parent().parent(".cc_item").fadeOut("fast",function(){$(this).remove()}),e.registerGlobalDomFunctions()}),$(".show_delete_attachment").off().on("click",function(t){if(e.manageDynamicLoader("show"),!confirm("Are you sure you want to delete this attachment?"))return e.manageDynamicLoader("hide"),!1;$this=$(this);var a=$this.data("attachment"),n=$this.data("id"),o=$this.data("type"),r={content_id:n,file:a,module_type:o};$.ajax({url:"email-template/show-delete-attachment",data:r,type:"POST",success:function(t){"undefined"!=typeof t.exc?(alert("Whoops! Your request can not be performed at this time. Please try again later."),e.manageDynamicLoader("hide")):e.commonViewLoad(t)}})}),$(".show_download_attachment").off().on("click",function(e){$(location).attr("href",$(this).data("href"))}),$(".datatable").on("click",".confirm_send",function(t){return t.preventDefault(),e.manageDynamicLoader("show"),confirm("Are you sure you want to change the status of this email?")?void(1==$(this).prop("checked")?n.commonAnchorHandler("email",$(this).data("eid"),"enable-confirm"):n.commonAnchorHandler("email",$(this).data("eid"),"disable-confirm")):(e.manageDynamicLoader("hide"),!1)}),$(".month_year_date").each(function(e){$(this).datepicker({format:"mm-yyyy",startView:"months",minViewMode:"months"})}),$("#email_queue_calender").datepicker({format:"mm-yyyy",startView:"months",minViewMode:"months"}).on("changeDate",function(t){$this=$(this),$this.unbind("changeDate"),e.manageDynamicLoader("show");var a=$(this).val();$.ajax({url:"email/monthly-queue-emails/"+a,type:"GET",success:function(t){if("undefined"!=typeof t.exc)alert("Whoops! Your request can not be performed at this time. Please try again later.");else{var a=$("#emails_queue_table");a.dataTable().fnDestroy(),$("#list_queue_table_body").html(t),a.dataTable().fnDraw()}return e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions(),!1}}),$this.bind("changeDate")}),$("#all_contact_export_project").on("change",function(e){var t=$(e.target).val();null!=t?$.ajax({url:"report/projects-placements",type:"post",data:{project_ids:t},success:function(e){return $("#all_contacts_placement").html(e),!1}}):(na_option='<option value="" disabled="disabled">N/A</option>',$("#all_contacts_placement").html(na_option))}),$(".datatable").on("click",".body-link, .table-link, .table-link-search",function(n){e.manageDynamicLoader("show"),$this=$(this);var o=$this.data("controller"),r=$this.data("mode"),i=$this.data("param"),l=$this.attr("class");return"table-link-search"==l&&e.setDefaultActionActive(o,r,"normal"),""!=i&&void 0!=i?postUrl=o+"/"+r+"/"+i:postUrl=o+"/"+r,"offer"!=o||"disable"!=r||confirm("Are you sure you want to disbale this offer?")?("body-link"==l&&"show"==r&&(a[0]=o,a[1]=r,a[2]=i,array_length=t.length-1,(t[array_length][0]!==o||t[array_length][1]!==r)&&(sublinks=[],sublinks[0]=o,sublinks[1]=r,sublinks[2]=i,t.push(sublinks),array_length=null)),$.ajax({url:postUrl,type:"get",success:function(t){var a=$this.data("search");if(void 0!=a){var n={view_page:t,search:a};e.commonViewLoad(n)}else e.commonViewLoad(t)}}),void n.preventDefault()):(e.manageDynamicLoader("hide"),!1)}),$(".body-link").off().on("click",function(n){e.manageDynamicLoader("show"),$this=$(this);var o=$this.data("controller"),r=$this.data("mode");return param_id=$this.data("param"),e.setDefaultActionActive(o,r,"normal"),""!=param_id&&void 0!=param_id?postUrl=o+"/"+r+"/"+param_id:postUrl=o+"/"+r,$(this).hasClass("add-back-link")&&(task_link=$('.task_link[data-controller="'+o+'"][data-mode="'+r+'"]'),$(".menu_bg").each(function(){$(this).removeClass("menu_bg")}),task_link.addClass("menu_bg")),"show"==r&&(a[0]=o,a[1]=r,a[2]=param_id,array_length=t.length-1,(t[array_length][0]!==o||t[array_length][1]!==r)&&(sublinks=[],sublinks[0]=o,sublinks[1]=r,sublinks[2]=param_id,t.push(sublinks),array_length=null)),$.ajax({url:postUrl,type:"get",success:function(t){e.commonViewLoad(t)}}),n.preventDefault(),n.stopPropagation(),!1}),$("span.user_add_back").on("click",function(t){return e.manageDynamicLoader("show"),r=$(this).data("controller"),i=$(this).data("mode"),n.commonLoadHandler(r,i),e.setDefaultActionActive(r,i,"normal"),!1}),$("#call_center_project").on("change",function(e){project_id=$(this).val(),""!=project_id?$.ajax({url:"placement/placements-call-center/"+project_id,type:"GET",success:function(e){return"undefined"!=typeof e.exc?alert("Whoops! Your request can not be performed at this time. Please try again later."):$("#call_center_placement").html(e),!1}}):(na_option='<option value="" disabled="disabled">N/A</option>',$("select#call_center_placement").html(na_option))}),$("input#entire_search").on("change",function(t){return t.preventDefault(),e.manageDynamicLoader("show"),n.commonFormHandler("dashboard","#entire_search","search"),$(".menu_bg").each(function(e){$(this).removeClass("menu_bg")}),$(".dashboard_menu").hasClass("active")&&$(".dashboard_menu").removeClass("active").removeClass("dashboard_active").find("span.arrow").removeClass("open"),!1})},commonViewLoad:function(t){if("undefined"!=typeof t.exc)"undefined"!=typeof t.custom_message?alert(t.custom_message):alert("Could not perform your action now. Please try again.");else if("undefined"!=typeof t.redirect)window.open(t.redirect);else if("undefined"!=typeof t.view)$(location).attr("href",$("#call-center-download").attr("href")),$(location).attr("href",$("#all_contacts_download").attr("href")),$(location).attr("href",$("#offer-month-download").attr("href")),$(".page-content").html(t.view);else if("undefined"!=typeof t.view_page)$(".page-content").html(t.view_page),$(".page-content .datatable").dataTable({bDestroy:!0,oSearch:{sSearch:t.search}});else if("undefined"!=typeof t.modal){if("#placement_add_form_modal"==t.selector?r.fetchPlacement():"#partner_add_form_modal"==t.selector?r.fetchOfferPartner():"#contact_assign_form_modal"==t.selector&&r.fetchPrimaryContact(),"#contact_assign_form_modal"==t.selector){t.selector="#partners_list_modal_row";var a=$(t.selector).parents(".modal-dialog").eq(0);return a.html(t.data),$(".datatable").DataTable(),$("#assign_offer_partners").modal("hide"),$("#list_offer_partners").modal("show"),e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions(),$("body").scrollTop(0),!1}var a=$(t.selector).parents(".modal-dialog").eq(0);"#partners_list_modal"==t.selector&&($("#list_offer_partners").modal("hide"),$("#assign_offer_partners").modal("show"),a=$("#contact_assign_form_modal").parents(".modal-dialog").eq(0)),a.html(t.data),$(".datatable").DataTable()}else $(".page-content").html(t),$(".page-content .datatable").DataTable(),$("input#entire_search").val(""),$("input#entire_search").unbind("change");return e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions(),$("body").scrollTop(0),!1},clearModalFormElements:function(e){return $(e).find("input,textarea,select").val(""),!1},setSidebarActive:function(e,a){var n=$("a[data-controller='"+e+"']").first();if("user"==e)var n=$("a[data-controller='"+e+"']").eq(1);var o=n.parents("li");$.each(o,function(e,n){return link=$(this).children("a"),link.hasClass("main_link")&&!link.parent("li").hasClass("open")?("remove"==a&&link.removeClass("main_link"),link.click(),t.pop(),!1):void 0})},setDefaultActionActive:function(e,t,a){$(".dashboard_menu").hasClass("dashboard_active")&&$(".dashboard_menu").removeClass("open").removeClass("active").removeClass("dashboard_active").find("span.arrow").removeClass("open"),$(".menu_bg").each(function(){$(this).removeClass("menu_bg")});var n=$('.task_link[data-controller="'+e+'"][data-mode="'+t+'"]');n.addClass("menu_bg"),"project"==e&&$(".add_info_menu").parent("li").eq(0).hasClass("closed")&&"normal"==a&&$(".add_info_menu").find("span.arrow").eq(0).addClass("open").end().end().siblings("ul").eq(0).slideDown(),("client"==e||"user"==e||"category"==e||"channel"==e||"country"==e||"language"==e||"offer_type"==e&&"index"==t)&&$(".add_info_menu").parent("li").eq(0).hasClass("closed")&&"normal"==a&&$(".add_info_menu").find("span.arrow").eq(0).addClass("open").end().end().siblings("ul").eq(0).slideDown();var o=n.parent("li").parent("ul").siblings(".main_module_link").eq(0);o.parent("li").eq(0).hasClass("closed")&&"normal"==a&&o.find("span.arrow").eq(0).addClass("open").end().end().siblings("ul").eq(0).slideDown();var r=n.parent("li").parent("ul").siblings(".sub_task_link").eq(0);if(!r.parent("li").eq(0).hasClass("open")){r.click();var i=r.parent("li").parent("ul").parent("li");i.hasClass("open")||i.click()}return!0}},t=["default"],a=["default"];$(".sub-menu a.link").off().on("click",function(n){e.manageDynamicLoader("show"),e.manageDynamicLoader("show");var o=$(this).data("controller"),r=$(this).data("mode");postUrl=o+"/"+r,a[0]=o,a[1]=r,a[0]=o,a[1]=r,array_length=t.length-1,(t[array_length][0]!==o||t[array_length][1]!==r)&&(sublinks=[],sublinks[0]=o,sublinks[1]=r,t.push(sublinks),array_length=null),e.setDefaultActionActive(o,r,"sidebar_link"),$.ajax({url:postUrl,type:"get",success:function(t){e.commonViewLoad(t)}}),n.preventDefault()}),$(".main_module_link").off().on("click",function(n){e.manageDynamicLoader("show");var o=$(this).data("controller"),r=$(this).data("mode");return postUrl=o+"/"+r,parent_li=$(this).parent("li"),a[0]=o,a[1]=r,array_length=t.length-1,(t[array_length][0]!==o||t[array_length][1]!==r)&&(sublinks=[],sublinks[0]=o,sublinks[1]=r,t.push(sublinks),array_length=null),$(this).hasClass("main_link")?$.ajax({url:postUrl,type:"get",success:function(t){e.setDefaultActionActive(o,r,"main_link"),e.commonViewLoad(t)}}):$(this).addClass("main_link"),$(this).hasClass("user_profile")&&($("a.menu_bg").each(function(){$(this).removeClass("menu_bg")}),dashboard_menu=$(".dashboard_menu"),dashboard_menu.removeClass("active").removeClass("dashboard_active").find(".arrow").removeClass("open")),n.preventDefault(),"profile"==r&&$("#user-options").click(),!1}),e.registerGlobalDomFunctions();var n={commonDeleteHandler:function(t,a,n){postUrl=t+"/"+n,$.ajax({url:postUrl,data:"delete_id="+a,type:"DELETE",success:function(t){e.commonViewLoad(t)}})},commonUpdateHandler:function(t,a,n){formData=$(a).serialize(),postUrl=t+"/"+n,$.ajax({url:postUrl,data:formData,type:"PUT",success:function(t){e.commonViewLoad(t)}})},commonLoadHandler:function(t,a){getUrl=t+"/"+a,$.ajax({url:getUrl,type:"GET",success:function(t){e.commonViewLoad(t)}})},commonAnchorHandler:function(t,a,n){postUrl=t+"/"+n,$.ajax({url:postUrl,data:"post_id="+a,type:"POST",success:function(t){e.commonViewLoad(t)}})},anchorHandlerPartialType:function(t,a,n,o){postUrl=t+"/"+n,sub_view="#"+o,$.ajax({url:postUrl,data:"post_id="+a,type:"POST",success:function(t){return"undefined"!=typeof t.exc?alert("Whoops! Your request can not be performed at this time. Please try again later."):$(sub_view).html(t),e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions(),$("body").scrollTop(0),!1}})},commonFormHandler:function(t,a,n){formData=$(a).serialize(),postUrl=t+"/"+n,$.ajax({url:postUrl,data:formData,type:"POST",success:function(t){e.commonViewLoad(t)}})},multipartFormHandler:function(t,a,n){formData=new FormData($(a)[0]),postUrl=t+"/"+n,$.ajax({url:postUrl,data:formData,enctype:"multipart/form-data",processData:!1,contentType:!1,type:"POST",success:function(t){e.commonViewLoad(t)}})},modalFormHandler:function(t,a,n){formData=$(a).serialize(),postUrl=t+"/"+n,$.ajax({url:postUrl,data:formData,type:"POST",success:function(t){response={data:t,modal:"yes",selector:a},e.commonViewLoad(response)}})},modalAnchorHandler:function(t,a,n,o){postUrl=t+"/"+n,$.ajax({url:postUrl,data:"post_id="+a,type:"POST",success:function(t){response={data:t,modal:"yes",selector:o},e.commonViewLoad(response)}})}},o={fileCheck:function(e){var t=["jpeg","jpg","png","bmp"];return-1!=$.inArray($(e).val().split(".").pop().toLowerCase(),t)?!1:(alert(" Invalid File Type!\nOnly '.jpeg','.jpg', '.png' formats are allowed."),void e.val(""))}},r={fetchPlacement:function(){return project_id=$("#offer_project_select").val(),""==project_id?(no_data='<p class="label">No matching records found.</p>',$("#offer_placement_select_wrapper").html(no_data),!1):void $.ajax({url:"placement/by-project/"+project_id,type:"GET",success:function(t){if("undefined"!=typeof t.exc)alert("Whoops! Your request can not be performed at this time. Please try again later.");else{if($("#offer_placement_select").length)$("#offer_placement_select").html("");else{var a='<select name="placement_ids[]" id="offer_placement_select" class="select2 form-control" multiple="multiple"></select>';$("#offer_placement_select_wrapper").html(a),$("#offer_placement_select").html("")}$.each(t.placements,function(e,t){var a='<option value="'+t.id+'">'+t.title+"</option>";$("#offer_placement_select").append(a)})}return e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions(),!1}})},fetchOfferPartner:function(){return project_id=$("#offer_project_select").val(),""==project_id?(no_data='<p class="label">No matching records found.</p>',$("#offer_partner_select_wrapper").html(no_data),!1):void $.ajax({url:"partner/by-project/"+project_id,type:"GET",success:function(t){if("undefined"!=typeof t.exc)alert("Whoops! Your request can not be performed at this time. Please try again later.");else{if($("#offer_partner_select").length)$("#offer_partner_select").html('<option value="">Select Below</option></select>');else{var a='<select name="partner_id" id="offer_partner_select" class="select2 form-control">';a+='<option value="">Select Below</option></select>',$("#offer_partner_select_wrapper").html(a)}$.each(t.partners,function(e,t){var a='<option value="'+t.id+'">'+t.partner_name+"</option>";$("#offer_partner_select").append(a)})}return e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions(),!1}})},fetchPrimaryContact:function(){return partner_id=$("#offer_partner_select").val(),""==partner_id&&void 0==partner_id?(no_data='<p class="label">No matching records found.</p>',$("#offer_partner_contact_select_wrapper").html(no_data),!1):void $.ajax({url:"contact/by-partner/"+partner_id,type:"GET",success:function(t){if("undefined"!=typeof t.exc)alert("Whoops! Your request can not be performed at this time. Please try again later.");else{if($("#offer_partner_contact_select").length)$("#offer_partner_contact_select").html('<option value="">Select Below</option></select>');else{var a='<select name="contact_id" id="offer_partner_contact_select" class="select2 form-control"><option value="">Select Below</option></select>';$("#offer_partner_contact_select_wrapper").html(a)}$.each(t.contacts,function(e,t){var a='<option value="'+t.id+'">'+t.first_name+" "+t.last_name+"</option>";$("#offer_partner_contact_select").append(a)})}return e.manageDynamicLoader("hide"),e.registerGlobalDomFunctions(),!1}})}}});